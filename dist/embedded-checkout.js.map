{"version":3,"sources":["webpack://checkoutKit/webpack/bootstrap","webpack://checkoutKit/external \"tslib\"","webpack://checkoutKit/external \"iframe-resizer\"","webpack://checkoutKit/./src/common/utility/bind-decorator.ts","webpack://checkoutKit/./src/common/error/errors/invalid-argument-error.ts","webpack://checkoutKit/./src/embedded-checkout/embedded-checkout-events.ts","webpack://checkoutKit/./src/common/error/errors/standard-error.ts","webpack://checkoutKit/./src/common/utility/set-prototype-of.ts","webpack://checkoutKit/./src/embedded-checkout/embedded-checkout.ts","webpack://checkoutKit/./src/embedded-checkout/is-embedded-checkout-event.ts","webpack://checkoutKit/./src/embedded-checkout/embedded-checkout-listener.ts","webpack://checkoutKit/./src/embedded-checkout/parse-origin.ts","webpack://checkoutKit/./src/embedded-checkout/errors/not-embeddable-error.ts","webpack://checkoutKit/./src/embedded-checkout/resizable-iframe-creator.ts","webpack://checkoutKit/./src/embedded-checkout/embed-checkout.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","bindDecorator","target","descriptor","bindMethodDecorator","decoratedTarget","_super","class_1","tslib__WEBPACK_IMPORTED_MODULE_0__","getOwnPropertyNames","forEach","getOwnPropertyDescriptor","bindClassDecorator","method","boundMethod","this","set","InvalidArgumentError","message","_this","type","EmbeddedCheckoutEventType","standard_error_StandardError","StandardError","setPrototypeOf","__proto__","_newTarget","Error","captureStackTrace","stack","external_tslib_","EmbeddedCheckout","_iframeCreator","_messageListener","_options","_isAttached","onComplete","on","embedded_checkout_events","CheckoutComplete","onError","CheckoutError","onLoad","CheckoutLoaded","onFrameLoad","FrameLoaded","attach","Promise","resolve","listen","createFrame","url","containerId","then","iframe","_iframe","catch","error","trigger","FrameError","payload","detach","stopListen","parentNode","removeChild","iFrameResizer","close","listener","addListener","off","removeListener","isEmbeddedCheckoutEventType","event","EmbeddedCheckoutListener","_origin","_isListening","_listeners","window","addEventListener","_handleMessage","removeEventListener","push","index","indexOf","splice","listeners","origin","keys","map","isEmbeddedCheckoutEvent","data","bind_decorator","parseOrigin","test","invalid_argument_error","anchor","document","createElement","href","protocol","hostname","port","NotEmbeddableError","ResizableIframeCreator","src","container","getElementById","_a","timeout","not_embeddable_error","style","border","display","width","appendChild","_toResizableFrame","timeoutInterval","reject","setTimeout","handleMessage","teardown","iframes","external_iframe_resizer_","scrolling","sizeWidth","heightCalculationMethod","length","clearTimeout","embedCheckout","options","embedded_checkout","resizable_iframe_creator","embedded_checkout_listener"],"mappings":"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","file":"embedded-checkout.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 74);\n","module.exports = require(\"tslib\");","module.exports = require(\"iframe-resizer\");","/**\n * Decorates a class or a method by binding all its prototype methods or itself\n * to the calling instance respectively.\n */\nexport default function bindDecorator<T extends Method>(target: object, key: string, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T>;\nexport default function bindDecorator<T extends Constructor<object>>(target: T): T;\nexport default function bindDecorator(target: any, key?: any, descriptor?: any): any {\n    if (!key || !descriptor) {\n        return bindClassDecorator(target);\n    }\n\n    return bindMethodDecorator(target, key, descriptor);\n}\n\n/**\n * Decorates a class by binding all its prototype methods to the calling\n * instance.\n */\nexport function bindClassDecorator<T extends Constructor<object>>(target: T): T {\n    const decoratedTarget = class extends target {};\n\n    Object.getOwnPropertyNames(target.prototype)\n        .forEach(key => {\n            const descriptor = Object.getOwnPropertyDescriptor(target.prototype, key);\n\n            if (!descriptor || key === 'constructor') {\n                return;\n            }\n\n            Object.defineProperty(\n                decoratedTarget.prototype,\n                key,\n                bindMethodDecorator(target.prototype, key, descriptor)\n            );\n        });\n\n    return decoratedTarget;\n}\n\n/**\n * Decorates a method by binding it to the calling instance.\n */\nexport function bindMethodDecorator<T extends Method>(target: object, key: string, descriptor: TypedPropertyDescriptor<T>): TypedPropertyDescriptor<T> {\n    if (typeof descriptor.value !== 'function') {\n        return descriptor;\n    }\n\n    let method: T = descriptor.value;\n\n    return {\n        get() {\n            const boundMethod = method.bind(this);\n\n            Object.defineProperty(this, key, {\n                ...descriptor,\n                value: boundMethod,\n            });\n\n            return boundMethod;\n        },\n        set(value) {\n            method = value;\n        },\n    };\n}\n\nexport type Constructor<T> = new (...args: any[]) => T;\nexport type Method = (...args: any[]) => any;\n","import StandardError from './standard-error';\n\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.type = 'invalid_argument';\n    }\n}\n","export enum EmbeddedCheckoutEventType {\n    CheckoutComplete = 'CHECKOUT_COMPLETE',\n    CheckoutError = 'CHECKOUT_ERROR',\n    CheckoutLoaded = 'CHECKOUT_LOADED',\n    FrameError = 'FRAME_ERROR',\n    FrameLoaded = 'FRAME_LOADED',\n}\n\nexport interface EmbeddedCheckoutEventMap {\n    [EmbeddedCheckoutEventType.CheckoutComplete]: EmbeddedCheckoutCompleteEvent;\n    [EmbeddedCheckoutEventType.CheckoutError]: EmbeddedCheckoutErrorEvent;\n    [EmbeddedCheckoutEventType.CheckoutLoaded]: EmbeddedCheckoutLoadedEvent;\n    [EmbeddedCheckoutEventType.FrameError]: EmbeddedCheckoutFrameErrorEvent;\n    [EmbeddedCheckoutEventType.FrameLoaded]: EmbeddedCheckoutFrameLoadedEvent;\n}\n\nexport type EmbeddedCheckoutEvent = (\n    EmbeddedCheckoutCompleteEvent |\n    EmbeddedCheckoutErrorEvent |\n    EmbeddedCheckoutFrameErrorEvent |\n    EmbeddedCheckoutFrameLoadedEvent |\n    EmbeddedCheckoutLoadedEvent\n);\n\nexport interface EmbeddedCheckoutCompleteEvent {\n    type: EmbeddedCheckoutEventType.CheckoutComplete;\n}\n\nexport interface EmbeddedCheckoutErrorEvent {\n    type: EmbeddedCheckoutEventType.CheckoutError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutLoadedEvent {\n    type: EmbeddedCheckoutEventType.CheckoutLoaded;\n}\n\nexport interface EmbeddedCheckoutFrameErrorEvent {\n    type: EmbeddedCheckoutEventType.FrameError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutFrameLoadedEvent {\n    type: EmbeddedCheckoutEventType.FrameLoaded;\n}\n\nexport interface EmbeddedCheckoutError {\n    message: string;\n    type?: string;\n    subtype?: string;\n}\n","import { setPrototypeOf } from '../../utility';\n\nimport CustomError from './custom-error';\n\nexport default class StandardError extends Error implements CustomError {\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = (new Error(this.message)).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import { IFrameComponent } from 'iframe-resizer';\n\nimport { EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport EmbeddedCheckoutListener from './embedded-checkout-listener';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nexport default class EmbeddedCheckout {\n    private _iframe?: IFrameComponent;\n    private _isAttached: boolean;\n\n    /**\n     * @internal\n     */\n    constructor(\n        private _iframeCreator: ResizableIframeCreator,\n        private _messageListener: EmbeddedCheckoutListener,\n        private _options: EmbeddedCheckoutOptions\n    ) {\n        this._isAttached = false;\n\n        if (this._options.onComplete) {\n            this.on(EmbeddedCheckoutEventType.CheckoutComplete, this._options.onComplete);\n        }\n\n        if (this._options.onError) {\n            this.on(EmbeddedCheckoutEventType.CheckoutError, this._options.onError);\n        }\n\n        if (this._options.onLoad) {\n            this.on(EmbeddedCheckoutEventType.CheckoutLoaded, this._options.onLoad);\n        }\n\n        if (this._options.onFrameLoad) {\n            this.on(EmbeddedCheckoutEventType.FrameLoaded, this._options.onFrameLoad);\n        }\n    }\n\n    attach(): Promise<this> {\n        if (this._isAttached) {\n            return Promise.resolve(this);\n        }\n\n        this._isAttached = true;\n        this._messageListener.listen();\n\n        return this._iframeCreator.createFrame(this._options.url, this._options.containerId)\n            .then(iframe => {\n                this._iframe = iframe;\n\n                return this;\n            })\n            .catch(error => {\n                this._isAttached = false;\n\n                this._messageListener.trigger({\n                    type: EmbeddedCheckoutEventType.FrameError,\n                    payload: error,\n                });\n\n                throw error;\n            });\n    }\n\n    detach(): void {\n        if (!this._isAttached) {\n            return;\n        }\n\n        this._isAttached = false;\n        this._messageListener.stopListen();\n\n        if (this._iframe && this._iframe.parentNode) {\n            this._iframe.parentNode.removeChild(this._iframe);\n            this._iframe.iFrameResizer.close();\n        }\n    }\n\n    on<TType extends keyof EmbeddedCheckoutEventMap>(type: TType, listener: (event: EmbeddedCheckoutEventMap[TType]) => void): void {\n        this._messageListener.addListener(type, listener);\n    }\n\n    off<TType extends keyof EmbeddedCheckoutEventMap>(type: TType, listener: (event: EmbeddedCheckoutEventMap[TType]) => void): void {\n        this._messageListener.removeListener(type, listener);\n    }\n}\n","import { EmbeddedCheckoutEvent, EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType } from './embedded-checkout-events';\n\nexport default function isEmbeddedCheckoutEvent(object: any): object is EmbeddedCheckoutEvent {\n    return Object.keys(EmbeddedCheckoutEventType)\n        .map((key: any) => EmbeddedCheckoutEventType[key])\n        .indexOf(object && object.type) >= 0;\n}\n\nexport function isEmbeddedCheckoutEventType<TType extends keyof EmbeddedCheckoutEventMap>(\n    event: EmbeddedCheckoutEvent,\n    type: TType\n): event is EmbeddedCheckoutEventMap[TType] {\n    return event.type === type;\n}\n","import { bindDecorator as bind } from '../common/utility';\n\nimport { EmbeddedCheckoutEvent, EmbeddedCheckoutEventMap } from './embedded-checkout-events';\nimport isEmbeddedCheckoutEvent from './is-embedded-checkout-event';\n\nexport default class EmbeddedCheckoutListener {\n    private _isListening: boolean;\n    private _listeners: {\n        [key: string]: Array<(event: EmbeddedCheckoutEventMap[keyof EmbeddedCheckoutEventMap]) => void>;\n    };\n\n    constructor(\n        private _origin: string\n    ) {\n        this._isListening = false;\n        this._listeners = {};\n    }\n\n    listen(): void {\n        if (this._isListening) {\n            return;\n        }\n\n        this._isListening = true;\n\n        window.addEventListener('message', this._handleMessage);\n    }\n\n    stopListen(): void {\n        if (!this._isListening) {\n            return;\n        }\n\n        this._isListening = false;\n\n        window.removeEventListener('message', this._handleMessage);\n    }\n\n    addListener<TType extends keyof EmbeddedCheckoutEventMap>(type: TType, listener: (event: EmbeddedCheckoutEventMap[TType]) => void): void {\n        if (!this._listeners[type]) {\n            this._listeners[type] = [];\n        }\n\n        this._listeners[type].push(listener);\n    }\n\n    removeListener<TType extends keyof EmbeddedCheckoutEventMap>(type: TType, listener: (event: EmbeddedCheckoutEventMap[TType]) => void): void {\n        const index = this._listeners[type] && this._listeners[type].indexOf(listener);\n\n        if (index >= 0) {\n            this._listeners[type].splice(index, 1);\n        }\n    }\n\n    trigger(event: EmbeddedCheckoutEvent): void {\n        const listeners = this._listeners[event.type];\n\n        if (!listeners) {\n            return;\n        }\n\n        listeners.forEach(listener => {\n            listener(event);\n        });\n    }\n\n    @bind\n    private _handleMessage(event: MessageEvent): void {\n        if ((event.origin !== this._origin) || !isEmbeddedCheckoutEvent(event.data)) {\n            return;\n        }\n\n        this.trigger(event.data);\n    }\n}\n","import { InvalidArgumentError } from '../common/error/errors';\n\nexport default function parseOrigin(url: string): string {\n    if (!/^(https?:)?\\/\\//.test(url)) {\n        throw new InvalidArgumentError('The provided URL must be absolute.');\n    }\n\n    // new URL() is not supported in IE11, use anchor tag instead\n    const anchor = document.createElement('a');\n\n    anchor.href = url;\n\n    return `${anchor.protocol}//${anchor.hostname}` + (anchor.port ? `:${anchor.port}` : '');\n}\n","import { StandardError } from '../../common/error/errors';\n\nexport default class NotEmbeddableError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Unable to embed the checkout form.');\n\n        this.type = 'not_embeddable';\n    }\n}\n","import { iframeResizer, IFrameComponent } from 'iframe-resizer';\n\nimport { EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport { NotEmbeddableError } from './errors';\nimport { isEmbeddedCheckoutEventType } from './is-embedded-checkout-event';\nimport parseOrigin from './parse-origin';\n\nexport default class ResizableIframeCreator {\n    constructor(\n        private _options?: { timeout: number }\n    ) {}\n\n    createFrame(src: string, containerId: string): Promise<IFrameComponent> {\n        const container = document.getElementById(containerId);\n        const { timeout = 5000 } = this._options || {};\n\n        if (!container) {\n            throw new NotEmbeddableError('Unable to embed the iframe because the container element could not be found.');\n        }\n\n        const iframe = document.createElement('iframe');\n\n        iframe.src = src;\n        iframe.style.border = 'none';\n        iframe.style.display = 'none';\n        iframe.style.width = '100%';\n\n        container.appendChild(iframe);\n\n        return this._toResizableFrame(iframe, timeout)\n            .catch(error => {\n                container.removeChild(iframe);\n\n                throw error;\n            });\n    }\n\n    private _toResizableFrame(iframe: HTMLIFrameElement, timeoutInterval: number): Promise<IFrameComponent> {\n        // Can't simply listen to `load` event because it always gets triggered even if there's an error.\n        // Instead, listen to the `load` inside the iframe and let the parent frame know when it happens.\n        return new Promise((resolve, reject) => {\n            const timeout = window.setTimeout(() => {\n                reject(new NotEmbeddableError('Unable to embed the iframe because the content could not be loaded.'));\n            }, timeoutInterval);\n\n            const handleMessage = (event: MessageEvent) => {\n                if (event.origin !== parseOrigin(iframe.src)) {\n                    return;\n                }\n\n                if (isEmbeddedCheckoutEventType(event.data, EmbeddedCheckoutEventType.FrameError)) {\n                    teardown();\n                    reject(new NotEmbeddableError(event.data.payload.message));\n                }\n\n                if (isEmbeddedCheckoutEventType(event.data, EmbeddedCheckoutEventType.FrameLoaded)) {\n                    iframe.style.display = '';\n\n                    const iframes = iframeResizer({\n                        scrolling: false,\n                        sizeWidth: false,\n                        heightCalculationMethod: 'lowestElement',\n                    }, iframe);\n\n                    teardown();\n                    resolve(iframes[iframes.length - 1]);\n                }\n            };\n\n            const teardown = () => {\n                window.removeEventListener('message', handleMessage);\n                window.clearTimeout(timeout);\n            };\n\n            window.addEventListener('message', handleMessage);\n        });\n    }\n}\n","import EmbeddedCheckout from './embedded-checkout';\nimport EmbeddedCheckoutListener from './embedded-checkout-listener';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport parseOrigin from './parse-origin';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\n/**\n * Embed the checkout form in an iframe.\n *\n * Once the iframe is embedded, it will automatically resize according to the\n * size of the checkout form. It will also notify the parent window when certain\n * events have occurred. i.e.: when the form is loaded and ready to be used.\n *\n * ```js\n * embedCheckout({\n *     url: 'https://checkout/url',\n *     container: 'container-id',\n * });\n * ```\n *\n * Please note that this feature is currently in an early stage of development.\n * Therefore the API is unstable and not ready for public consumption.\n *\n * @alpha\n * @param options - Options for embedding the checkout form.\n * @returns A promise that resolves to an instance of `EmbeddedCheckout`.\n */\nexport default function embedCheckout(options: EmbeddedCheckoutOptions): Promise<EmbeddedCheckout> {\n    const embeddedCheckout = new EmbeddedCheckout(\n        new ResizableIframeCreator(),\n        new EmbeddedCheckoutListener(parseOrigin(options.url)),\n        options\n    );\n\n    return embeddedCheckout.attach();\n}\n"],"sourceRoot":""}